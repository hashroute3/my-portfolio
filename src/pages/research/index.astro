---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const journals = (await getCollection('journals')).sort((a, b) => b.data.year - a.data.year);
---

<BaseLayout title="Research & Journals" description="Peer-reviewed journals and research articles.">
  <article class="mx-auto max-w-5xl px-6 py-16">
    <header>
      <h1 class="font-serif text-3xl font-semibold text-surface-50">Research & Journals</h1>
      <p class="mt-2 text-surface-400">Peer-reviewed journals and research articles.</p>
    </header>

    <ul class="mt-12 space-y-8" role="list">
      {journals.map((entry) => (
        <li class="rounded-xl border border-surface-800 bg-surface-900/50 p-6 transition-colors hover:border-surface-700">
          <h2 class="font-serif text-lg font-semibold text-surface-50">
            {entry.data.title}
          </h2>
          <p class="mt-2 text-sm text-surface-400">
            <span class="font-medium text-surface-300">{entry.data.publicationVenue}</span>
            <span class="mx-2">Â·</span>
            <span>{entry.data.year}</span>
            {entry.data.peerReviewed && (
              <span class="ml-2 rounded bg-surface-800 px-1.5 py-0.5 text-xs text-surface-400">Peer-reviewed</span>
            )}
          </p>
          <p class="mt-3 text-surface-300">
            {entry.data.summary}
          </p>
          <div class="mt-4 flex flex-wrap gap-3">
            {entry.data.externalUrl && (
              <a href={entry.data.externalUrl} class="text-sm text-sky-400 hover:underline" target="_blank" rel="noopener">
                View article
              </a>
            )}
            {entry.data.doi && (
              <a href={`https://doi.org/${entry.data.doi}`} class="text-sm text-sky-400 hover:underline" target="_blank" rel="noopener">
                DOI
              </a>
            )}
          </div>
        </li>
      ))}
    </ul>

    {journals.length === 0 && (
      <p class="mt-12 text-surface-500">No journal entries yet. Add markdown files in <code class="rounded bg-surface-800 px-1.5 py-0.5">src/content/journals/</code>.</p>
    )}
  </article>
</BaseLayout>
